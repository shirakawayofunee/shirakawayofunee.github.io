<script>
    // ... (保留你原有的 gallery 逻辑代码) ...

    // ================== BGM 控制逻辑 (移植版) ==================
    
    // 音乐控制函数
    function muteMusic(num) {
        var bgmPlayer = document.getElementById('bgm');
        // 获取所有的播放(动图)和停止(静止)按钮
        var playButtons = document.querySelectorAll('.imgMusicPlay'); // 播放状态显示的图
        var stopButtons = document.querySelectorAll('.imgMusicStop'); // 停止状态显示的图

        if (!bgmPlayer) {
            console.error('未找到 id="bgm" 的音频元素');
            return;
        }

        if (num === 1) {
            // 操作：暂停音乐
            console.log('Pause BGM');
            bgmPlayer.pause();
            
            // 界面：隐藏动图，显示静止图
            playButtons.forEach(btn => btn.style.display = 'none');
            stopButtons.forEach(btn => btn.style.display = 'block');
            
        } else if (num === 2) {
            // 操作：播放音乐
            console.log('Play BGM');
            var playPromise = bgmPlayer.play();

            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    // 播放成功
                    bgmPlayer.muted = false;
                    // 界面：显示动图，隐藏静止图
                    playButtons.forEach(btn => btn.style.display = 'block');
                    stopButtons.forEach(btn => btn.style.display = 'none');
                }).catch(error => {
                    console.error('自动播放被阻止，等待用户交互:', error);
                    // 如果播放失败（通常是因为浏览器策略），保持静止图标显示
                });
            }
        }
    }

    // 页面加载完成后尝试自动播放（可选）
    // 注意：现代浏览器通常会阻止没有用户交互的自动播放
    document.addEventListener('DOMContentLoaded', function () {
        // 尝试触发一次播放，如果失败则静音播放或等待用户点击
        var bgmPlayer = document.getElementById('bgm');
        if(bgmPlayer) {
            // 绑定一次点击事件，用户点击页面任何位置时尝试播放（解决浏览器限制）
            document.addEventListener('click', function tryAutoPlay() {
                if (bgmPlayer.paused) {
                    muteMusic(2);
                }
                // 移除监听，避免重复触发
                document.removeEventListener('click', tryAutoPlay);
            }, { once: true });
        }
    });
</script>