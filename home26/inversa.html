<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INVERSA Effect Replica</title>
    <!-- 引入 GSAP 动画库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <style>
        /* --- 基础设置 --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background-color: #13140e; 
            color: #f4f3e8; 
            font-family: 'Courier New', Courier, monospace; /* 模仿 JetBrains Mono */
            overflow-x: hidden;
        }

        /* --- 占位区域，为了让页面能滚动 --- */
        .spacer { height: 50vh; display: flex; align-items: center; justify-content: center; opacity: 0.5; }

        /* --- 核心滚动容器 (Height: 400vh) --- */
        .scrolly-section {
            position: relative;
            height: 400vh; /* 这里的超高度提供了滚动的“时间轴” */
        }

        /* --- 粘性视口 (Sticky Viewport) --- */
        .sticky-wrapper {
            position: sticky;
            top: 0;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* --- 视觉层 (Visual Layers) --- */
        .visual-container {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
        }

        .layer {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            will-change: opacity, clip-path;
        }

        /* Layer 1: Damaged (灰色图) */
        .layer-damaged img {
            width: 100%; height: 100%; object-fit: cover; filter: grayscale(100%) contrast(1.2);
        }

        /* Layer 2: Tech/Command (数字指挥中心) */
        .layer-tech {
            background-color: #181813;
            /* 模拟 Grid 网格线 */
            background-image: 
                linear-gradient(rgba(235, 252, 114, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(235, 252, 114, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: 2;
            opacity: 0; /* 初始隐藏 */
            /* 关键：初始遮罩是一个小圆点 */
            clip-path: circle(0% at 50% 50%); 
        }

        /* GPS 热点特效 */
        .gps-hotspot {
            position: absolute;
            width: 10px; height: 10px;
            background-color: #f1664d; /* 红色热点 */
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        /* 脉冲动画 */
        .gps-hotspot::after {
            content: ''; position: absolute; inset: -10px;
            border: 1px solid #f1664d; border-radius: 50%;
            animation: pulse 2s infinite; opacity: 0;
        }
        @keyframes pulse {
            0% { transform: scale(0.5); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        /* Layer 3: Restoration (绿色恢复图) */
        .layer-restored {
            z-index: 3;
            opacity: 0; /* 初始隐藏 */
            background: #000;
        }
        .layer-restored img {
            width: 100%; height: 100%; object-fit: cover;
        }

        /* --- 文字层 (Text Slides) --- */
        .text-container {
            position: absolute;
            z-index: 10;
            width: 100%;
            height: 100%;
            pointer-events: none; /* 让鼠标穿透文字去滚动 */
        }

        .text-slide {
            position: absolute;
            top: 50%; left: 10%; /* 定位在左侧 */
            transform: translateY(-50%);
            max-width: 400px;
            opacity: 0; /* 初始隐藏 */
        }

        .text-slide h3 {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            text-transform: uppercase;
            display: flex; align-items: center; gap: 10px;
        }
        
        /* 闪烁的小方块装饰 */
        .blinker {
            width: 8px; height: 8px; background: currentColor;
            animation: blink 1s step-end infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }

        .text-slide p {
            font-size: 1.5rem;
            line-height: 1.4;
            font-weight: 300;
        }

        /* 颜色定义 */
        .text-1 h3 { color: #f1664d; } /* 对应 Damaged */
        .text-2 h3 { color: #ebfc72; } /* 对应 Tech/Yellow */
        .text-3 h3 { color: #00d399; } /* 对应 Restored/Green */

    </style>
</head>
<body>

    <div class="spacer">Scroll Down to Enter</div>

    <!-- 核心动效区块 -->
    <section class="scrolly-section" id="targetSection">
        <div class="sticky-wrapper">
            
            <!-- 背景视觉层 -->
            <div class="visual-container">
                <!-- 1. 受损生态 (底图) -->
                <div class="layer layer-damaged">
                    <!-- 使用占位图，模拟干涸的河床 -->
                    <img src="https://images.unsplash.com/photo-1519810755548-392116d9a642?q=80&w=2071&auto=format&fit=crop" alt="Damaged">
                </div>

                <!-- 2. 数字指挥中心 (遮罩层) -->
                <div class="layer layer-tech">
                    <!-- 模拟 GPS 定位点，随机分布 -->
                    <div class="gps-hotspot" style="top: 40%; left: 60%"></div>
                    <div class="gps-hotspot" style="top: 55%; left: 45%"></div>
                    <div class="gps-hotspot" style="top: 30%; left: 30%"></div>
                    <div class="gps-hotspot" style="top: 70%; left: 70%"></div>
                    <!-- 一个中心扫描圈 -->
                    <div style="position: absolute; top:50%; left:50%; width: 200px; height: 200px; border: 1px solid #ebfc72; border-radius: 50%; transform: translate(-50%, -50%); opacity: 0.5;"></div>
                </div>

                <!-- 3. 生态恢复 (顶层图) -->
                <div class="layer layer-restored">
                    <!-- 使用占位图，模拟茂密的森林 -->
                    <img src="https://images.unsplash.com/photo-1448375240586-dfd8d395ea6c?q=80&w=2070&auto=format&fit=crop" alt="Restored">
                </div>
            </div>

            <!-- 文字层 -->
            <div class="text-container">
                <!-- 第一段文字 -->
                <div class="text-slide text-1">
                    <h3><span class="blinker" style="background: #f1664d;"></span>Damaged Ecosystems</h3>
                    <p>Invasive species degrade ecosystems by overwhelming native wildlife.</p>
                </div>

                <!-- 第二段文字 -->
                <div class="text-slide text-2">
                    <h3><span class="blinker" style="background: #ebfc72;"></span>Invasive Management</h3>
                    <p>Origin digital command center deploys specialists with precision.</p>
                </div>

                <!-- 第三段文字 -->
                <div class="text-slide text-3">
                    <h3><span class="blinker" style="background: #00d399;"></span>Restoration</h3>
                    <p>With invasives controlled, habitats rebound and wildlife thrives.</p>
                </div>
            </div>

        </div>
    </section>

    <div class="spacer">End of Section</div>
    <div class="spacer" style="height: 100vh"></div>

    <script>
        // 注册插件
        gsap.registerPlugin(ScrollTrigger);

        // 创建时间轴
        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: "#targetSection",
                start: "top top", // 当区块顶部到达视口顶部时
                end: "bottom bottom", // 当区块底部到达视口底部时
                scrub: 1, // 平滑滚动 (1秒延迟)
                pin: ".sticky-wrapper", // 固定住里面的内容
                // markers: true // 调试模式，开发时可以打开
            }
        });

        // --- 动画序列 ---

        // 0. 初始状态：显示 Text 1
        tl.to(".text-1", { opacity: 1, duration: 1 });

        // --- 阶段一转阶段二 (Damaged -> Tech) ---
        
        // 1. Text 1 上滑消失
        tl.to(".text-1", { y: -50, opacity: 0, duration: 2 }, "+=1");

        // 2. Tech Layer (遮罩) 展开
        // clip-path 从 0% 变成 150% (覆盖全屏)，模拟原来的 mask-size 变大
        tl.to(".layer-tech", { 
            opacity: 1, 
            clipPath: "circle(150% at 50% 50%)", 
            duration: 5 
        }, "<"); // "<" 表示和上一个动画同时也开始一点点

        // 3. Text 2 浮现
        tl.fromTo(".text-2", 
            { y: 50, opacity: 0 },
            { y: 0, opacity: 1, duration: 2 }
        , "-=2"); // 提前一点出现

        // 4. GPS 点位稍微动一下 (增加一点视差感)
        tl.to(".gps-hotspot", { scale: 1.2, duration: 2 }, "<");

        // --- 阶段二转阶段三 (Tech -> Restoration) ---

        // 5. Text 2 上滑消失
        tl.to(".text-2", { y: -50, opacity: 0, duration: 2 }, "+=2");

        // 6. Restored Layer 浮现 (这次用简单的透明度渐变，模拟原来那种柔和切换)
        tl.to(".layer-restored", { opacity: 1, duration: 4 }, "<");

        // 7. Text 3 浮现
        tl.fromTo(".text-3", 
            { y: 50, opacity: 0 },
            { y: 0, opacity: 1, duration: 2 }
        , "-=2");

        // 留白时间，让用户读完最后一段字
        tl.to({}, { duration: 2 });

    </script>
</body>
</html>